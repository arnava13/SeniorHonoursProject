
 -------- Parameters:
bayesian True
test_mode False
n_test_idx 2
seed 1312
fine_tune False
one_vs_all False
c_0 ['lcdm']
c_1 ['True', 'dgp', 'ds', 'fR', 'rand--save_ckpt', 'wcdm']
dataset_balanced False
include_last False
log_path 
restore False
fname ds_ee2_1k_equalweight_randoms_kmax_5
model_name custom
my_path None
DIR data/ds_ee2_train_1k
TEST_DIR data/ds_ee2_test_1k
models_dir models/
save_ckpt True
out_path_overwrite False
curves_folder data/curve_files_sys/theory_error
save_processed_spectra False
im_depth 500
im_width 1
im_channels 4
swap_axes True
sort_labels True
norm_data_name /planck_ee2.txt
normalization stdcosmo
sample_pace 4
k_max 5.0
i_max None
add_noise True
n_noisy_samples 10
add_shot False
add_sys True
add_cosvar True
sigma_sys None
sys_scaled None
sys_factor None
sys_max None
sigma_curves 0.05
sigma_curves_default 0.05
rescale_curves uniform
z_bins [0, 1, 2, 3]
n_dense 1
filters [8, 16, 32]
kernel_sizes [10, 5, 2]
strides [2, 2, 1]
pool_sizes [2, 2, 0]
strides_pooling [2, 1, 0]
add_FT_dense False
trainable False
unfreeze False
lr 0.01
drop 0.5
n_epochs 50
val_size 0.15
test_size 0.0
batch_size 3000
patience 50
GPU True
decay 0.95
BatchNorm True
group_lab_dict {'True': 'non_lcdm', 'dgp': 'non_lcdm', 'ds': 'non_lcdm', 'fR': 'non_lcdm', 'rand--save_ckpt': 'non_lcdm', 'wcdm': 'non_lcdm', 'lcdm': 'lcdm'}
save_indexes False
------------ CREATING DATA GENERATORS ------------

labels : ['dgp', 'ds', 'fr', 'lcdm', 'rand', 'wcdm']
Labels encoding: 
{'dgp': 0, 'ds': 1, 'fr': 2, 'lcdm': 3, 'rand': 4, 'wcdm': 5}
n_labels : 6
dgp - 1000 training examples
ds - 1000 training examples
fr - 1000 training examples
lcdm - 1000 training examples
rand - 1000 training examples
wcdm - 1000 training examples

N. of data files: 1000
get_all_indexes labels dict: {'dgp': 0, 'ds': 1, 'fr': 2, 'lcdm': 3, 'rand': 4, 'wcdm': 5}
create_generators n_labels_eff: 6
create_generators len_c1: 1
--Train
batch_size: 3000
- Cut sample
bs: 3000
N_labels: 6
N_noise: 10
len_c1: 1
Indexes length: 1000
n_keep: 1000
Sampling
New length: 1000
N batches: 20.0
 len_C1: 1
N indexes: 50.0
Ok.
N. of test files used: 1000
Data Generator Initialization
Using z bins [0, 1, 2, 3]
Normalisation file is /planck_ee2.txt
Specified k_max is 5.0
Corresponding i_max is 112
Closest k to k_max is 4.936132
New data dim: (112, 1)
Final i_max used is 112
one_vs_all: False
dataset_balanced: False
base_case_dataset: True
N. classes: 6
N. n_classes in output: 6
LABELS: ['dgp', 'ds', 'fr', 'lcdm', 'rand', 'wcdm']
list_IDs length: 1000
n_indexes (n of file IDs read for each batch): 50
batch size: 3000
n_batches : 20
For each batch we read 50 file IDs
For each file ID we have 6 labels
For each ID, label we have 10 realizations of noise
In total, for each batch we have 3000 training examples
Input batch size: 3000
N of batches to cover all file IDs: 20
------------ DONE ------------

Input shape (112, 4)
------------ BUILDING MODEL ------------

Model n_classes : 6 
Features shape: (3000, 112, 4)
Labels shape: (3000, 6)
using 1D layers and 4 channels
Expected output dimension of layer conv1d_flipout: 52.0
Expected output dimension of layer max_pooling1d: 26.0
Expected output dimension of layer conv1d_flipout_1: 11.5
Expected output dimension of layer max_pooling1d_1: 10.5
Expected output dimension of layer conv1d_flipout_2: 9.5
Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 112, 4)]          0         
                                                                 
 conv1d_flipout (Conv1DFlip  (None, 52, 8)             648       
 out)                                                            
                                                                 
 max_pooling1d (MaxPooling1  (None, 26, 8)             0         
 D)                                                              
                                                                 
 batch_normalization (Batch  (None, 26, 8)             32        
 Normalization)                                                  
                                                                 
 conv1d_flipout_1 (Conv1DFl  (None, 11, 16)            1296      
 ipout)                                                          
                                                                 
 max_pooling1d_1 (MaxPoolin  (None, 10, 16)            0         
 g1D)                                                            
                                                                 
 batch_normalization_1 (Bat  (None, 10, 16)            64        
 chNormalization)                                                
                                                                 
 conv1d_flipout_2 (Conv1DFl  (None, 9, 32)             2080      
 ipout)                                                          
                                                                 
 batch_normalization_2 (Bat  (None, 9, 32)             128       
 chNormalization)                                                
                                                                 
 global_average_pooling1d (  (None, 32)                0         
 GlobalAveragePooling1D)                                         
                                                                 
 dense_flipout (DenseFlipou  (None, 32)                2080      
 t)                                                              
                                                                 
 batch_normalization_3 (Bat  (None, 32)                128       
 chNormalization)                                                
                                                                 
 dense_flipout_1 (DenseFlip  (None, 6)                 390       
 out)                                                            
                                                                 
=================================================================
Total params: 6846 (26.74 KB)
Trainable params: 6670 (26.05 KB)
Non-trainable params: 176 (704.00 Byte)
_________________________________________________________________
None
Computing loss for randomly initialized model...
Loss before loading weights/ 1.9353333

------------ RESTORING CHECKPOINT ------------

Looking for ckpt in models/ds_ee2_1k_equalweight_randoms_kmax_5/tf_ckpts/
Restoring checkpoint from models/ds_ee2_1k_equalweight_randoms_kmax_5/tf_ckpts/ckpt-30
Loss after loading weights/ 1.0179489

Threshold probability for classification: 0.5 
Accuracy on 0 batch using median of sampled probabilities: 0.536 %
Accuracy on 0 batch using median of sampled probabilities, not considering unclassified examples: 0.7928994 %
Accuracy on 1 batch using median of sampled probabilities: 0.53033334 %
Accuracy on 1 batch using median of sampled probabilities, not considering unclassified examples: 0.7745862 %
Accuracy on 2 batch using median of sampled probabilities: 0.5453333 %
Accuracy on 2 batch using median of sampled probabilities, not considering unclassified examples: 0.7731569 %
Accuracy on 3 batch using median of sampled probabilities: 0.5093333 %
Accuracy on 3 batch using median of sampled probabilities, not considering unclassified examples: 0.75419545 %
Accuracy on 4 batch using median of sampled probabilities: 0.5593333 %
Accuracy on 4 batch using median of sampled probabilities, not considering unclassified examples: 0.78338003 %
Accuracy on 5 batch using median of sampled probabilities: 0.5326667 %
Accuracy on 5 batch using median of sampled probabilities, not considering unclassified examples: 0.78256613 %
Accuracy on 6 batch using median of sampled probabilities: 0.52033335 %
Accuracy on 6 batch using median of sampled probabilities, not considering unclassified examples: 0.75776696 %
Accuracy on 7 batch using median of sampled probabilities: 0.5366667 %
Accuracy on 7 batch using median of sampled probabilities, not considering unclassified examples: 0.7781537 %
Accuracy on 8 batch using median of sampled probabilities: 0.525 %
Accuracy on 8 batch using median of sampled probabilities, not considering unclassified examples: 0.7594021 %
Accuracy on 9 batch using median of sampled probabilities: 0.52933335 %
Accuracy on 9 batch using median of sampled probabilities, not considering unclassified examples: 0.74519 %
Accuracy on 10 batch using median of sampled probabilities: 0.546 %
Accuracy on 10 batch using median of sampled probabilities, not considering unclassified examples: 0.78 %
Accuracy on 11 batch using median of sampled probabilities: 0.5313333 %
Accuracy on 11 batch using median of sampled probabilities, not considering unclassified examples: 0.76561 %
Accuracy on 12 batch using median of sampled probabilities: 0.53866667 %
Accuracy on 12 batch using median of sampled probabilities, not considering unclassified examples: 0.7944936 %
Accuracy on 13 batch using median of sampled probabilities: 0.53333336 %
Accuracy on 13 batch using median of sampled probabilities, not considering unclassified examples: 0.7718283 %
Accuracy on 14 batch using median of sampled probabilities: 0.5513333 %
Accuracy on 14 batch using median of sampled probabilities, not considering unclassified examples: 0.7739822 %
Accuracy on 15 batch using median of sampled probabilities: 0.54733336 %
Accuracy on 15 batch using median of sampled probabilities, not considering unclassified examples: 0.7800475 %
Accuracy on 16 batch using median of sampled probabilities: 0.531 %
Accuracy on 16 batch using median of sampled probabilities, not considering unclassified examples: 0.75070685 %
Accuracy on 17 batch using median of sampled probabilities: 0.54966664 %
Accuracy on 17 batch using median of sampled probabilities, not considering unclassified examples: 0.76662016 %
Accuracy on 18 batch using median of sampled probabilities: 0.5086667 %
Accuracy on 18 batch using median of sampled probabilities, not considering unclassified examples: 0.75098425 %
Accuracy on 19 batch using median of sampled probabilities: 0.54433334 %
Accuracy on 19 batch using median of sampled probabilities, not considering unclassified examples: 0.7839654 %
-- Accuracy on test set using median of sampled probabilities: 0.5353 % 

-- Accuracy on test set using median of sampled probabilities, not considering unclassified examples: 0.7709768 % 

Adding Not classified label
Saved confusion matrix at models/ds_ee2_1k_equalweight_randoms_kmax_5/cm_DS_EE2_1K_EQUALWEIGHT_RAND_kmax_5_frozen_weights.pdf
Saved confusion matrix values at models/ds_ee2_1k_equalweight_randoms_kmax_5/cm_DS_EE2_1K_EQUALWEIGHT_RAND_kmax_5_frozen_weights_values.txt
